***03-4 branch 병합하기***
# 03-4 Branch 병합하기
- branch마다 각자 커밋할 수 있더라도 어느 시점에서는 branch작업을 마무리하고 기존 branch와 합쳐야한다. 이것은 branch 병합(merge)라 한다.

**서로 다른 파일 병합하기**

1. 홈 디렉토리에 'manual-2'라는 디렉토리를 만들고 Git 저장소를 생성.
```
$ git init manual-2
```
2. work.txt 파일을 생성한 후 '1'을 입력한 후 저장

3. 'o2'라는 branch 생성

4. main branch에 main.txt라는 파일을 하나 더 생성, 'main 2'라고 입력한 후 저장. 이후 'main work2'라는 메세지와 함께 커밋

5. o2 branch에서 o2.txt 파일 생성 후 '2'라는 내용 입력 후 저장. 이어서 o2.txt 파일은 'o2 work 2' 메세지와 함께 커밋

6. o2 branch에서 작업이 모두 끝났다고 가정. o2 branch의 내용을 main branch로 병합. branch로 병합하려면 먼저 main branch로 전환

7. branch를 병합할 때는 git merge 명령 뒤에 가져올 branch 이름을 입력
```
$ git merge o2
```
8. o2 branch에 있던 o2.txt 파일이 main branch에 병합

9. git log 명령으로 branch와 커밋이 어떻게 병합되었는지도 확인

**빨리 감기 병합이란**
- main branch에 branch를 분기한 후 main branch에 아무 변화가 없다면(새로운 커밋을 만들지 않았다면) 분기한 branch에서 만든 최신 커밋을 main branch가 가리키게 하면 된다. 이 경우 화면에 커밋 해시가 업데이트되었다는 내용과 함께 'fast-forward'라는 메세지가 출력된다. 이런 병합을 빨리 감기 병합(fast-forward merge)이라고 한다.

**서로 다른 branch에서 한 문서의 다른 부분을 수정했을 때 병합하기**
- 같은 문서에서 서로 다른 부분을 수정했을 때 병합하는 과정
1. 홈 디렉토리로 이동한 후 'manual-3'이라는 Git 저장소를 만들고, manual-3 디렉토리로 이동

2. work.txt 파일을 생성 후 텍스트를 입력
```
#title
content


#title
content
```
3. 생성한 work.txt를 스테이지에 올리고 커밋한다. 커밋 메세지는 "work 1"이라 한다.

4. o2라는 새로운 branch를 생성

5. main branch에서 문서를 수정

6. 첫번째 공백줄에 'main content 2'라고 입력한 후 저아의 한다.

7. 'main work2'하는 메세지와 함께 커밋

8. o2 branch의 work.txt 파일도 수정

9. 두 번째 공백 줄에 'o2 conntent 2' 수정한 후 저장

10. 커밋한다. 커밋 메세지는 'o2 work 2'

11. branch 양쪽에서 한 문서를 수정 이후 병합

12. main branch로 끙어온다.

13. conflict 이 메세지는 work.txt를 자동 병합하는 동안 충돌이 발생했다는 뜻
  
14. 사용자가 출동 부분을 직접 해결한 후 커밋해야 한다.

15. 수정한 work.txt를 스테이지에 올리고 커밋하면 된다. 커밋 메세지는 merge o2 branch


**병합 및 충돌 해결 프로그램**
- Git의 branch병합을 자동으로 처리해 주고 충돌을 해결해 주는 프로그램이 많다. 협업 시에는 병합 자동화 프로그램도 사용을 고려해야 한다.

**병합이 끝난 branch 삭제하기**
- branch를 병합한 후 더 이상 사용하지 않는 branch는 Git에서 삭제할 수 있다. 단, 이렇게 branch를 삭제하더라도 완전히 제거된 것은 아니며 같은 이름의 branch를 만들면 예전 내용을 다시 볼 수 있다.

1. 현재 저장소에 어떤 branch가 있는지 확인

2. main branch로 전환

3. o2 branch를 삭제
```
$ git branch -d o2
```
4. branch가 삭제가 되었지만 삭제한 branch는 같은 이름으로 다시 branch를 생성하면 전에 작업했던 내용이 그대로 나타난다. 즉, branch는 삭제한다는 것은 Git의 흐름 속에서 감춘 것.

**cherry-pick으로 병합하기**
- Git에 'cherry-pick'이라는 또 하나의 병합 방법이 있다. 
- cherry-pick은 branch와 branch를 병합하긴 하지만 branch 전체를 병합하는 것이 아니라, branch 중 특정 버전의 변경 내용만 병합하려고 할 때 사용하는 기능이다.

1. 홈 디렉토리에 cherry-pick 디렉토리를 Git 저장소로 만들고, cherry-pick 디렉토리로 이동한다.

2. 우선 새로운 branch를 생성하기 전에 버전을 만근다. 터미널에서는 ;으로 구분해서 여러개의 명령을 한꺼번에 처리할 수 있다. 명령어 touch는 빈 파일을 생성한다.
```
$ touch init.txt; git add init; git commit -m "init"
```
3. 새로운 branch topic을 생성한다. git log 옵션 중에 --all 옵션은 최신 커밋 뿐만 아니라 모든 커밋을 전부 출력하기 위한 옵션
```
$ git branch topic
$ git log --oneline --all --graph
```
4. main branch에 m1과 m2라는 2개의 버전을 생성. 이후 git log로 확인
```
$ touch m1; git add m1; git commit -m "m1"
$ touch m2; git add m2; git commit -m "m2"
$ git log --oneline --all --graph
```
5. topic 브랜치로 전환 후, t1,t2,t3 버전을 생성
```
$ touch t1; git add t1; git commit -m "t1"
$ touch t2; git add t2; git commit -m "t2"
$ touch t3; git add t3; git commit -m "t3"
$ git log --oneline --all --graph
```
6. topic branch의 t2 버전에서 적용했던 내용을 main branch에도 적용하고 싶을 때 사용하는 것이 바로 cherry-pick이다. topic branch의 여러 버전 중 하나를 골라와서 병합. 

7. main branch로 전환
```
$ git switch main
```
8. topic branch의 t2버전만 병합하려면, cherry-pick 명령 다음에 t2에 해당하는 커밋 해시를 알려주면 된다.
```
$ git cherry-pick 대상 해시
```
